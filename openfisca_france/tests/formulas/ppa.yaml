- name: "PPA - Pas d'activité, pas d'éligibilité"
  period: 2016-01
  input_variables:
    age: 40
    ppa_revenu_activite:
      2015-12: 0
      2015-11: 0
      2015-10: 0
  output_variables:
    ppa_eligibilite: False

- name: "PPA - Pas d'éligibilité si moins de 18 ans"
  period: 2016-01
  input_variables:
    age: 17
    ppa_revenu_activite:
      2015-12: 500
      2015-11: 500
      2015-10: 500
  output_variables:
    ppa_eligibilite: False

- name: "PPA - Eligibilité"
  period: 2016-01
  input_variables:
    age: 18
    ppa_revenu_activite:
      2015-12: 500
      2015-11: 500
      2015-10: 500
  output_variables:
    ppa_eligibilite: True

- name: "PPA personne seule, pas de bonification"
  period: 2016-01
  input_variables:
    age: 40
    salaire_net:
      2016-01: 500
      2015-12: 500
      2015-11: 500
      2015-10: 500
  output_variables:
    rsa: 524.16 - 500 # Pas de pente sur le RSA socle
    ppa: 524.16 - 0.38*500 - (524.16 - 500) # Le second terme de la différence n'est pas nul

- name: "PPA personne en couple, pas de bonification"
  period: 2016-01
  familles:
    parents: ["parent1", "parent2"]
  individus:
    - id: "parent1"
      age: 40
    - id: "parent2"
      age: 40
      salaire_net:
        2016-01: 500
        2015-12: 500
        2015-11: 500
        2015-10: 500
  output_variables:
    # mff = 524.16 * (1 + 0.5) = 786.24
    rsa: 786.24 - 500
    ppa: 786.24 - 0.38 * 500 - (786.24 - 500)

- name: "PPA en couple avec 1 enfant, pas de bonification"
  period: 2016-01
  familles:
    parents: ["parent1", "parent2"]
    enfants: ["enfant1"]
  individus:
    - id: "parent1"
      age: 40
      salaire_net:
        2016-01: 500
        2015-12: 500
        2015-11: 500
        2015-10: 500
    - id: "parent2"
      age: 40
    - id: "enfant1"
      age: 10
  output_variables:
    # mff = 524.16 * (1 + 0.5 + 0.3) = 943.49
    rsa: 943.49 - 500
    ppa: 943.49 - 0.38 * 500 - (943.49 - 500)

- name: "PPA en couple avec 3 enfant, pas de bonification"
  period: 2016-01
  familles:
    parents: ["parent1", "parent2"]
    enfants: ["enfant1", "enfant2", "enfant3"]
    rsa_base_ressources_prestations_familiales: 0 # On ne prend pas en comptes les prestations CAF pour ce test
  individus:
    - id: "parent1"
      age: 40
    - id: "parent2"
      age: 40
      salaire_net:
        2016-01: 500
        2015-12: 500
        2015-11: 500
        2015-10: 500
    - id: "enfant1"
      age: 10
    - id: "enfant2"
      age: 11
    - id: "enfant3"
      age: 12
  output_variables:
    # mff = 524.16 * (1 + 0.5 + 2 * 0.3 + 0.4) = 1310.40
    rsa: 1310.40 - 500
    ppa: 1310.40 - 0.38 * 500 - (1310.40 - 500)

- name: "PPA majoré: personne seule avec 1 enfant de moins de 3 ans"
  period: 2016-01
  familles:
    parents: ["parent1"]
    enfants: ["enfant1"]
    rsa_base_ressources_prestations_familiales: 0 # On ne prend pas en comptes les prestations CAF pour ce test
  individus:
    - id: "parent1"
      age: 40
      salaire_net:
        2016-01: 500
        2015-12: 500
        2015-11: 500
        2015-10: 500
    - id: "enfant1"
      age: 2
  output_variables:
    # mff = 524.16 * (1.28412 + 0.42804) = 897.45
    rsa: 897.45 - 500
    ppa: 897.45 - 0.38 * 500 - (897.45 - 500)


- name: "PPA personne seule, revenus variables, pas de bonification"
  period: 2016-01
  input_variables:
    age: 40
    salaire_net:
      2016-01: 500
      2015-12: 500
      2015-11: 450
      2015-10: 550
  output_variables:
    rsa: 524.16 - 500
    ppa: 524.16 - 0.38 * 500 - (524.16 - 500)

- name: "PPA personne en couple avec deux sources de revenus, pas de bonification"
  period: 2016-01
  familles:
    parents: ["parent1", "parent2"]
    ppa_eligibilite: True
    aides_logement: 0
  individus:
    - id: "parent1"
      age: 40
      salaire_net:
        2016-01: 300
        2015-12: 300
        2015-11: 300
        2015-10: 300
    - id: "parent2"
      age: 40
      salaire_net:
        2016-01: 300
        2015-12: 300
        2015-11: 300
        2015-10: 300
  output_variables:
    # mff = 524.16 * 1.5 = 786.24
    rsa_revenu_activite: 600
    rsa: 786.24 - 600
    ppa: 786.24 - 0.38 * 600 - (786.24 - 600)

- name: "PPA personne seule avec revenus bonifiés (>95 SMIC horaire brut)"
  period: 2016-01
  relative_error_margin: 0.05
  input_variables:
    age: 40
    salaire_net:
      2016-01: 913 # > 95 smic horaire brut
      2015-12: 913
      2015-11: 913
      2015-10: 913
  output_variables:
    ppa_bonification:
      2015-12: 67
      2015-11: 67
      2015-10: 67
    rsa: 0
    ppa: 524.16 + 67 - 0.38 * 913 # =244.21

- name: "PPA personne seule avec revenus bonifiés (>59 SMIC horaire brut)"
  period: 2016-01
  relative_error_margin: 0.05
  input_variables:
    age: 40
    salaire_net:
      2016-01: 800 # > 59 smic horaire brut, < 95
      2015-12: 800
      2015-11: 800
      2015-10: 800
  output_variables:
    ppa_bonification:
      2015-12: 45
      2015-11: 45
      2015-10: 45
    rsa: 0
    ppa: 524.16 + 45 - 0.38 * 800

- name: "PPA personne en couple avec deux sources de revenus, pas de bonification"
  period: 2016-01
  relative_error_margin: 0.05
  familles:
    parents: ["parent1", "parent2"]
    ppa_eligibilite: True
    aides_logement: 0
  individus:
    - id: "parent1"
      age: 40
      salaire_net:
        2016-01: 913
        2015-12: 913
        2015-11: 913
        2015-10: 913
    - id: "parent2"
      age: 40
      salaire_net:
        2016-01: 800
        2015-12: 800
        2015-11: 800
        2015-10: 800
  output_variables:
    # mff = 524.16 * 1.5 = 786.24
    rsa: 0
    ppa: 786.24 - 0.38 * (800 + 913) + 67 + 45

- name: "PPA/RSA forfait logement 1 personne"
  period: 2016-01
  input_variables:
    statut_occupation_famille: 2 # propriétaire
    age: 40
  output_variables:
    rsa_forfait_logement:
      2016-01: 62.90

- name: "PPA/RSA forfait logement 2 personnes"
  period: 2016-01
  familles:
    parents: ["parent1", "parent2"]
    statut_occupation_famille: 2 # propriétaire
  individus:
    - id: "parent1"
      age: 40
    - id: "parent2"
      age: 40
  output_variables:
    rsa_forfait_logement:
      2016-01: 125.80

- name: "PPA/RSA forfait logement 3 personnes"
  period: 2016-01
  familles:
    parents: ["parent1", "parent2"]
    enfants: ["enfant1"]
    statut_occupation_famille: 2 # propriétaire
  individus:
    - id: "parent1"
      age: 40
    - id: "parent2"
      age: 40
    - id: "enfant1"
      age: 15
  output_variables:
    rsa_forfait_logement:
      2016-01: 155.68

- name: "Prise en compte du forfait logement"
  period: 2016-01
  relative_error_margin: 0.05
  input_variables:
    age: 40
    statut_occupation_famille: 2 # propriétaire
    salaire_net:
      2016-01: 913 # > 95 smic horaire brut
      2015-12: 913
      2015-11: 913
      2015-10: 913
  output_variables:
    rsa_forfait_logement: 62.90
    ppa: 244.21 - 62.90

- name: "PPA < seuil de versement"
  period: 2016-01
  relative_error_margin: 0.05
  input_variables:
    age: 40
    statut_occupation: 4
    salaire_net:
      2015-12: 1520 # > 59 smic horaire brut, < 95
      2015-11: 1520
      2015-10: 1520
    ppa_eligibilite: True
  output_variables:
    ppa:
      2016-01: 0 # 525 + 67 - 0.38 * 1520 = 14.40 < 15

- name: "PPA: ressources prises en compte pour l'activité"
  period: 2016-01
  input_variables:
    salaire_net: 300
    revenus_stage_formation_pro: 300
    bourse_recherche: 300
    indemnites_journalieres_maternite: 300
    indemnites_journalieres_accident_travail: 300
    indemnites_chomage_partiel: 300
  output_variables:
    ppa_revenu_activite:
      2016-02: 600

- name: "PPA: ressources prises en compte hors activité"
  period: 2016-01
  input_variables:
    af_base: 300
    paje_base: 300
    rsa_forfait_asf: 300
    paje_clca: 300
    paje_prepare: 300
    paje_colca: 300
    chonet: 300
    rstnet: 300
    retraite_combattant: 300
    dedommagement_victime_amiante: 300
    pensions_alimentaires_percues: 300
    prestation_compensatoire: 300
  output_variables:
    ppa_ressources_hors_activite:
      2016-02: 1200

- name: "PPA: étudiant éligible (ressources > plancher)"
  period: 2016-01
  input_variables:
    salaire_net:
      2015-12: 900
      2015-11: 900
      2015-10: 900
  output_variables:
    ppa_eligibilite: True

- name: "PPA: étudiant non éligible (ressources < plancher)"
  period: 2016-01
  input_variables:
    salaire_net:
      2015-12: 800
      2015-11: 800
      2015-10: 800
  output_variables:
    ppa_eligibilite: True

- name: "PPA: étudiant éligible (majoré)"
  period: 2016-01
  input_variables:
    salaire_net:
      2015-12: 800
      2015-11: 800
      2015-10: 800
    rsa_majore_eligibilite: True
  output_variables:
    ppa_eligibilite: True
